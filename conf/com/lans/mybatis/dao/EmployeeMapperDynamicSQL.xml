<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lans.mybatis.dao.EmployeeMapperDynamicSQL">
	<select id="getEmpsByConditionIf" resultType="employee">
		SELECT * FROM employee 
		<where> 
			<if test="id!=null">id=#{id}</if>
			<if test="lastName != null &amp;&amp; lastName != &quot;&quot;">AND last_name LIKE #{lastName}</if>
			<if test="email != null and email.trim() != ''">AND email=#{email}</if>
			<if test="gender == 0 or gender == 1">AND gender=#{gender}</if>
		</where>
	</select>
	
	<select id="getEmpsByConditionTrim" resultType="employee">
		SELECT * FROM employee 
		<trim prefix="where" prefixOverrides="AND |OR" suffix="" suffixOverrides="and|,">
			<if test="id!=null">id=#{id} AND </if>
			<if test="lastName != null &amp;&amp; lastName != &quot;&quot;">last_name LIKE #{lastName} AND </if>
			<if test="email != null and email.trim() != ''">email=#{email} AND </if>
			<if test="gender == 0 or gender == 1">gender=#{gender}</if>
		</trim> 
	</select>
	
	<select id="getEmpsByConditionChoose" resultType="employee">
		SELECT * FROM employee 
		<where>
			<choose>
				<when test="id!=null">id=#{id}</when>
				<when test="lastName!=null">last_name LIKE #{lastName}</when>
				<when test="email!=null">email=#{email}</when>
				<otherwise>gender=0</otherwise>
			</choose> 
		</where>
	</select>
	
	<update id="updateEmp">
		UPDATE employee 
		<set>
			<if test="lastName!=null">last_name=#{lastName},</if>
			<if test="email!=null">email=#{email},</if>
			<if test="gender!=null">gender=#{gender}</if> 
		</set> 
		WHERE id=#{id}
	</update>
	
	<select id="getEmpsByConditionForeach" resultType="employee">
		SELECT * FROM employee WHERE id IN
		<foreach collection="list" item="id" open="(" separator="," close=")">
			#{id}
		</foreach>
	</select>
	
	<insert id="addEmps">
		INSERT INTO employee(last_name,email,gender,dept_id) VALUES 
		<foreach collection="emps" item="emp" separator=",">
			(#{emp.lastName},#{emp.email},#{emp.gender},#{emp.dept.id})
		</foreach>
	</insert>
</mapper>